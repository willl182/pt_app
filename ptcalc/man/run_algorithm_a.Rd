% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pt_robust_stats.R
\name{run_algorithm_a}
\alias{run_algorithm_a}
\title{ISO 13528 Algorithm A - Robust Mean and Standard Deviation}
\usage{
run_algorithm_a(values, ids = NULL, max_iter = 50, tol = 0.001)
}
\arguments{
\item{values}{A numeric vector of participant results.}

\item{ids}{Optional vector of participant identifiers (same length as values).}

\item{max_iter}{Maximum number of iterations (default: 50).}

\item{tol}{Convergence tolerance for x* and s* (default: 1e-03).}
}
\value{
A list containing:
\itemize{
\item assigned_value: Robust mean (x*)
\item robust_sd: Robust standard deviation (s*)
\item iterations: Data frame of iteration history
\item weights: Data frame with participant weights
\item converged: Logical indicating convergence
\item effective_weight: Sum of final weights
\item error: Error message or NULL if successful
}
}
\description{
Iterative algorithm for computing robust estimates of location (x*) and
scale (s*) from proficiency testing data. Down-weights outliers using
Huber-type weighting.
}
\details{
Algorithm A is an iterative procedure that computes robust estimates:
\enumerate{
\item Initialize with median (x*) and scaled MAD (s*)
\item Compute standardized residuals: u = (x - x*) / (1.5 * s*)
\item Apply Huber weights: w = 1 if |u| <= 1, else w = 1/u^2
\item Update x* and s* using weighted mean and weighted SD
\item Repeat until convergence (changes < tolerance)
}

Reference: ISO 13528:2022, Annex C
}
\examples{
# Robust mean/sd with outlier in data
values <- c(10.1, 10.2, 9.9, 10.0, 10.3, 50.0)  # 50 is outlier
result <- run_algorithm_a(values)
cat("Robust mean:", result$assigned_value, "\n")
cat("Robust SD:", result$robust_sd, "\n")

}
\seealso{
\code{\link{calculate_niqr}}, \code{\link{calculate_mad_e}}
}
